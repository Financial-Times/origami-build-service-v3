service: origami-build-service
#app: your-app-name
#tenant: your-tenant-name

frameworkVersion: "=1.49.0"

provider:
  name: aws
  region: ${opt:region, 'eu-west-1'}
  role: arn:aws:iam::${env:AWS_ACCOUNT_ID}:role/ApplicationRoleFor_${self:service}
  runtime: nodejs10.x
  stackTags:
    systemCode: ${self:service}
    teamDL: origami.support@ft.com
    environment: ${self:custom.tags.${self:provider.stage}.environment}
  stage: ${opt:stage, self:custom.defaultStage}
  timeout: 30 # The default is 6 seconds. Note: API Gateway current maximum is 30 seconds
  versionFunctions: false # Optional function versioning

custom:
  apigwBinary:
    types:
      - '*/*'
  defaultStage: dev
  dotenv:
    include:
      - SENTRY_DSN
  output:
    file: ./.${self:provider.stage}-stack.yml
  sentry:
    dsn: ${env:SENTRY_DSN}
    organization: ${env:SENTRY_ORGANISATION}
    project: ${env:SENTRY_PROJECT}
    authToken: ${env:SENTRY_AUTH_TOKEN}
    release:
      version: 'git'
  serverless-offline:
    dontPrintOutput: false
  tags:
    dev:
      environment: t
    qa:
      environment: t
    prod:
      environment: p


plugins:
  - serverless-apigw-binary
  - serverless-offline
  - serverless-sentry
  - serverless-stack-output
  - serverless-dotenv-plugin

functions:
  hello:
    handler: functions/hello.hello
    events:
     - http:
         path: /hello
         method: get
